---
title: "Tests Before Factor Analysis"
author: "Luis Carlos Castillo"
date: "`r Sys.Date()`"
institute: |
  | 
  | University of Urbino and Universty of Bremen
fontsize: 9pt
header-includes:
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{graphicx}
  - \setbeamerfont{normal text}{size=\tiny} # Adjust this line as needed
output:
  beamer_presentation: default
  slidy_presentation: default
---

```{r setup, include=FALSE}
#### 0. Load the necessary packages #####
library(readr)
library(readxl)
library(dplyr)
library(tidyr)
library(here)
library(git2r)
library(visdat)
library(naniar)
library(chatgpt)
library(gptstudio)
require(devtools)
library(caret)
library(mice)
library(knitr)
library(kableExtra)
library(corrplot)
library(forcats)
library(DescTools)
library(fastDummies)
library(corrplot)
library(Compind)
library(lme4)
library(Matrix)
library(ltm)
library(writexl)

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(echo = FALSE, warning = F, message = F )
kableExtra.auto_format = FALSE
knitr.table.format = "latex"
knitr::opts_knit$set(kable.force.latex = TRUE)

```

## Data Preparation for Factor Analysis 

```{r loading the environment, echo=FALSE}


load(here("Data", "Processed", "ICT_Combined.rda"))
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

options(scipen=999)

ict_combined$A2_A2 <- ict_combined$A2_A2/ 100
ict_combined$A2_C2 <- ict_combined$A2_C2/ 100


```


This section will present the different statistics and test before constructing 
the composite index. It includes the following: 

- **ANOVA (Analysis of Variance) and Chi-Squared tests** are fundamental statistical methods used to assess differences in data. ANOVA evaluates whether there are significant differences in the mean scores of continuous variables across different groups, such as different years. Chi-Squared tests, on the other hand, determine if there are significant differences in the distribution of categorical variables across groups.

  In this study, these tests were applied to evaluate the significant differences in the means and distributions of variables across six years. This evaluation is crucial in the preliminary stages of factor analysis, as it ensures the suitability and consistency of the data. Significant differences highlighted by these tests can indicate variability that might impact the factor analysis. Understanding the data distribution and ensuring data quality through these tests helps validate the assumptions required for factor analysis. Thus, conducting ANOVA and Chi-Squared tests provides a comprehensive understanding of the data, ensuring it is appropriately structured and reliable for subsequent factor analysis.
  
## Interpreting the results

Interpreting the results of hypothesis testing involves understanding the null (H0) and alternative (H1) hypotheses. The null hypothesis states there is no significant difference between groups, while the alternative suggests a significant difference exists. We calculate a p-value to test these hypotheses. If the p-value is less than 0.05, we reject the null hypothesis, indicating a significant difference. If it's greater, we fail to reject the null hypothesis, suggesting any differences are likely due to chance.

In this study, rejecting the null hypothesis in ANOVA tests indicates significant differences in mean scores of continuous variables across years. For Chi-Squared tests, it suggests significant differences in the distribution of categorical variables over time. These results help validate the data's variability, ensuring its suitability for factor analysis.

## ANOVA and Chi-Squaredd for ACCESS Over the Six Yeaars


```{r ANOVA_A, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

rownames(test_results_Access) = NULL

write_xlsx(test_results_Access, here("Data", "Processed", "test_results_Access.xlsx"))

kable(test_results_Access, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) %>%   pack_rows("",1,6) %>% pack_rows("",7,9)

```

## Chi-Squaredd for SKILLS Over the Six Yeaars

```{r chi_squ_S, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

rownames(test_results_Skills) = NULL

write_xlsx(test_results_Skills, here("Data", "Processed", "test_results_Skills.xlsx"))

kable(test_results_Skills, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))  %>%   pack_rows("",1,9) %>% pack_rows("",10,12)

```


## Chi-Squaredd for USAGE Over the Six Yeaars

```{r chi_squ_U, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

rownames(test_results_Usage) = NULL

write_xlsx(test_results_Usage, here("Data", "Processed", "test_results_Usage.xlsx"))

kable(test_results_Usage, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))  %>%   pack_rows("",1,11) %>% pack_rows("",12,14)

```


## 

- **Correlation of Variables:** Understanding correlations between variables is foundational in factor analysis. This assessment helps identify whether groups of variables share common patterns or underlying factors, which justifies their reduction into fewer dimensions.


- **Internal Consistency and Cronbach’s Alpha:**

  Internal Consistency refers to the reliability of items within a scale or test to consistently measure the same underlying construct. It is a crucial aspect of scale reliability and validity. Cronbach’s Alpha is a specific statistic used to measure this internal consistency. It quantifies how well a set of items measure an underlying (unobserved) construct.

  - Thresholds for Cronbach's Alpha:
    - $\alpha \geq 0.90$: Excellent
    - $0.80 \leq \alpha < 0.90$: Good
    - $0.70 \leq \alpha < 0.80$: Acceptable

  A high Cronbach's Alpha indicates that the items are highly correlated and thus reliably measure the same construct. This helps to ensure that the dimensions extracted from factor analysis are reliable.

## Data Preparation for Factor Analysis II


- **Bartlett's Test of Sphericity:** This test checks whether the correlation matrix is an identity matrix, which would indicate that the variables are unrelated and unsuitable for structure detection. A significant result from Bartlett’s test supports the factorability of the correlation matrix.

  - **Null Hypothesis (H0)**: The correlation matrix is an identity matrix, indicating that the variables are unrelated and unsuitable for structure detection.
  - **Alternative Hypothesis (H1)**: The correlation matrix is not an identity matrix, indicating significant correlations among the variables, making them suitable for structure detection.

### Interpretation of the p-value:
- **p $< 0.05$**: Reject the null hypothesis. There are significant correlations among the variables, suggesting that the correlation matrix is factorable. This means that the data is suitable for factor analysis.

- **p $\geq 0.05$**: Fail to reject the null hypothesis. There is not enough evidence to suggest that the correlation matrix is different from an identity matrix, indicating that the variables may not be suitable for structure detection.


## 1. 2014 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA14, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

## 

### 1.2. Cronbach's Alpha Access 2014

 - For continuous varibles
 
```{r alpha1_A2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2014 <- results[["2014"]]$A_continuous_reliability$total

cont_alpha_A2014 <- cont_alpha_A2014[, -c(6:9)]

kable(cont_alpha_A2014, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2014 <- results[["2014"]]$A_binary_reliability$total

binary_alpha_A2014 <- binary_alpha_A2014[, -c(6:9)]

kable(binary_alpha_A2014, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2014 <- results[["2014"]]$A_combined_reliability$total

comb_alpha_A2014 <- comb_alpha_A2014[, -c(6:9)]

kable(comb_alpha_A2014, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 1.3. Bartlett's Test of Sphericity Access 2014


```{r Bartletts_A2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_A14 <- cortest.bartlett(cor_matrix_sortedA14, nrow(A_data_2014))

# Extract the results
bartlett_test_A14 <- data.frame(
  Statistic = round(bartlett_test_A14$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A14$df,
  p_Value = round(bartlett_test_A14$p.value, 3)
)

kable(bartlett_test_A14, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 2. 2014 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2014, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS14, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

## 

### 2.2. Cronbach's Alpha Skills 2014

 - For binary varibles
 
```{r alpha2_S2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2014 <- results[["2014"]]$S_reliability$total

binary_alpha_S2014 <- binary_alpha_S2014[, -c(6:9)]

kable(binary_alpha_S2014, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 2.3. Bartlett's Test of Sphericity Skills 2014


```{r Bartletts_S2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S14 <- cortest.bartlett(cor_matrix_sortedS14, nrow(S_data_2014))

# Extract the results
bartlett_test_S14 <- data.frame(
  Statistic = round(bartlett_test_S14$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S14$df,
  p_Value = round(bartlett_test_S14$p.value, 3)
)

kable(bartlett_test_S14, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 3. 2014 - Usage - Correlation, Cronbach, and Bartlett's Ttests

### 3.1. Correlations


```{r corr_U_2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU14, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```


## 

### 3.2. Cronbach's Alpha Usage 2014

 - For binary varibles
 
```{r alpha2_U2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2014 <- results[["2014"]]$U_reliability$total

binary_alpha_U2014 <- binary_alpha_U2014[, -c(6:9)]

kable(binary_alpha_U2014, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2014


```{r Bartletts_U2014, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U14 <- cortest.bartlett(cor_matrix_sortedU14, nrow(U_data_2014))

# Extract the results
bartlett_test_U14 <- data.frame(
  Statistic = round(bartlett_test_U14$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U14$df,
  p_Value = round(bartlett_test_U14$p.value, 3)
)

kable(bartlett_test_U14, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 1. 2015 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA15, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

## 

### 1.2. Cronbach's Alpha Access 2015

 - For continuous varibles
 
```{r alpha1_A2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2015 <- results[["2015"]]$A_continuous_reliability$total

cont_alpha_A2015 <- cont_alpha_A2015[, -c(6:9)]

kable(cont_alpha_A2015, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2015 <- results[["2015"]]$A_binary_reliability$total

binary_alpha_A2015 <- binary_alpha_A2015[, -c(6:9)]

kable(binary_alpha_A2015, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2015 <- results[["2015"]]$A_combined_reliability$total

comb_alpha_A2015 <- comb_alpha_A2015[, -c(6:9)]

kable(comb_alpha_A2015, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

### 1.3. Bartlett's Test of Sphericity Access 2015


```{r Bartletts_A2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_A15 <- cortest.bartlett(cor_matrix_sortedA15, nrow(A_data_2015))

# Extract the results
bartlett_test_A15 <- data.frame(
  Statistic = round(bartlett_test_A15$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A15$df,
  p_Value = round(bartlett_test_A15$p.value, 3)
)

kable(bartlett_test_A15, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 2. 2015 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2015, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS15, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

## 

### 2.2. Cronbach's Alpha Skills 2015


 - For binary varibles
 
```{r alpha2_S2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2015 <- results[["2015"]]$S_reliability$total

binary_alpha_S2015 <- binary_alpha_S2015[, -c(6:9)]

kable(binary_alpha_S2015, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 2.3. Bartlett's Test of Sphericity Skills 2015


```{r Bartletts_S2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S15 <- cortest.bartlett(cor_matrix_sortedS15, nrow(S_data_2015))

# Extract the results
bartlett_test_S15 <- data.frame(
  Statistic = round(bartlett_test_S15$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S15$df,
  p_Value = round(bartlett_test_S15$p.value, 3)
)

kable(bartlett_test_S15, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 3. 2015 - Usage - Correlation, Cronbach, and Bartlett's Ttests

### 3.1. Correlations


```{r corr_U_2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU15, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

## 

### 3.2. Cronbach's Alpha Usage 2015


 - For binary varibles
 
```{r alpha2_U2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2015 <- results[["2015"]]$U_reliability$total

binary_alpha_U2015 <- binary_alpha_U2015[, -c(6:9)]

kable(binary_alpha_U2015, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2015


```{r Bartletts_U2015, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U15 <- cortest.bartlett(cor_matrix_sortedU15, nrow(U_data_2015))

# Extract the results
bartlett_test_U15 <- data.frame(
  Statistic = round(bartlett_test_U15$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U15$df,
  p_Value = round(bartlett_test_U15$p.value, 3)
)

kable(bartlett_test_U15, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 1. 2016 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA16, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

###  1.2. Cronbach's Alpha Access 2016

 - For continuous varibles
 
```{r alpha1_A2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2016 <- results[["2016"]]$A_continuous_reliability$total

cont_alpha_A2016 <- cont_alpha_A2016[, -c(6:9)]

kable(cont_alpha_A2016, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2016 <- results[["2016"]]$A_binary_reliability$total

binary_alpha_A2016 <- binary_alpha_A2016[, -c(6:9)]

kable(binary_alpha_A2016, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2016 <- results[["2016"]]$A_combined_reliability$total

comb_alpha_A2016 <- comb_alpha_A2016[, -c(6:9)]

kable(comb_alpha_A2016, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

### 1.3. Bartlett's Test of Sphericity Access 2016


```{r Bartletts_A2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_A16 <- cortest.bartlett(cor_matrix_sortedA16, nrow(A_data_2016))

# Extract the results
bartlett_test_A16 <- data.frame(
  Statistic = round(bartlett_test_A16$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A16$df,
  p_Value = round(bartlett_test_A16$p.value, 3)
)

kable(bartlett_test_A16, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 2. 2016 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2016, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS16, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

##

### 2.2. Cronbach's Alpha Skills 2016


 - For binary varibles
 
```{r alpha2_S2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2016 <- results[["2016"]]$S_reliability$total

binary_alpha_S2016 <- binary_alpha_S2016[, -c(6:9)]

kable(binary_alpha_S2016, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 2.3. Bartlett's Test of Sphericity Skills 2016


```{r Bartletts_S2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S16 <- cortest.bartlett(cor_matrix_sortedS16, nrow(S_data_2016))

# Extract the results
bartlett_test_S16 <- data.frame(
  Statistic = round(bartlett_test_S16$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S16$df,
  p_Value = round(bartlett_test_S16$p.value, 3)
)

kable(bartlett_test_S16, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 3. 2016 - Usage - Correlation, Cronbach, and Bartlett's Ttests

### 3.1. Correlations


```{r corr_U_2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU16, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 3.2. Cronbach's Alpha Usage 2016


 - For binary varibles
 
```{r alpha2_U2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2016 <- results[["2016"]]$U_reliability$total

binary_alpha_U2016 <- binary_alpha_U2016[, -c(6:9)]

kable(binary_alpha_U2016, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2016


```{r Bartletts_U2016, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U16 <- cortest.bartlett(cor_matrix_sortedU16, nrow(U_data_2016))

# Extract the results
bartlett_test_U16 <- data.frame(
  Statistic = round(bartlett_test_U16$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U16$df,
  p_Value = round(bartlett_test_U16$p.value, 3)
)

kable(bartlett_test_U16, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 1. 2017 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA17, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

## 

### 1.2. Cronbach's Alpha Access 2017

 - For continuous varibles 
 
```{r alpha1_A2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2017 <- results[["2017"]]$A_continuous_reliability$total

cont_alpha_A2017 <- cont_alpha_A2017[, -c(6:9)]

kable(cont_alpha_A2017, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2017 <- results[["2017"]]$A_binary_reliability$total

binary_alpha_A2017 <- binary_alpha_A2017[, -c(6:9)]

kable(binary_alpha_A2017, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2017 <- results[["2017"]]$A_combined_reliability$total

comb_alpha_A2017 <- comb_alpha_A2017[, -c(6:9)]

kable(comb_alpha_A2017, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

### 1.3. Bartlett's Test of Sphericity Access 2017


```{r Bartletts_A2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_A17 <- cortest.bartlett(cor_matrix_sortedA17, nrow(A_data_2017))

# Extract the results
bartlett_test_A17 <- data.frame(
  Statistic = round(bartlett_test_A17$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A17$df,
  p_Value = round(bartlett_test_A17$p.value, 3)
)

kable(bartlett_test_A17, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 2. 2017 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2017, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS17, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

## 

### 2.2. Cronbach's Alpha Skills 2017


 - For binary varibles
 
```{r alpha2_S2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2017 <- results[["2017"]]$S_reliability$total

binary_alpha_S2017 <- binary_alpha_S2017[, -c(6:9)]

kable(binary_alpha_S2017, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 2.3. Bartlett's Test of Sphericity Skills 2017


```{r Bartletts_S2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S17 <- cortest.bartlett(cor_matrix_sortedS17, nrow(S_data_2017))

# Extract the results
bartlett_test_S17 <- data.frame(
  Statistic = round(bartlett_test_S17$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S17$df,
  p_Value = round(bartlett_test_S17$p.value, 3)
)

kable(bartlett_test_S17, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 3. 2017 - Usage - Correlation, Cronbach, and Bartlett's Ttests

### 3.1. Correlations


```{r corr_U_2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU17, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 3.2. Cronbach's Alpha Usage 2017


 - For binary varibles
 
```{r alpha2_U2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2017 <- results[["2017"]]$U_reliability$total

binary_alpha_U2017 <- binary_alpha_U2017[, -c(6:9)]

kable(binary_alpha_U2017, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2017


```{r Bartletts_U2017, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U17 <- cortest.bartlett(cor_matrix_sortedU17, nrow(U_data_2017))

# Extract the results
bartlett_test_U17 <- data.frame(
  Statistic = round(bartlett_test_U17$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U17$df,
  p_Value = round(bartlett_test_U17$p.value, 3)
)

kable(bartlett_test_U17, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 1. 2018 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA18, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 1.2. Cronbach's Alpha Access 2018

 - For continuous varibles
 
```{r alpha1_A2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2018 <- results[["2018"]]$A_continuous_reliability$total

cont_alpha_A2018 <- cont_alpha_A2018[, -c(6:9)]

kable(cont_alpha_A2018, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2018 <- results[["2018"]]$A_binary_reliability$total

binary_alpha_A2018 <- binary_alpha_A2018[, -c(6:9)]

kable(binary_alpha_A2018, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2018 <- results[["2018"]]$A_combined_reliability$total

comb_alpha_A2018 <- comb_alpha_A2018[, -c(6:9)]

kable(comb_alpha_A2018, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

### 1.3. Bartlett's Test of Sphericity Access 2018


```{r Bartletts_A2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_A18 <- cortest.bartlett(cor_matrix_sortedA18, nrow(A_data_2018))

# Extract the results
bartlett_test_A18 <- data.frame(
  Statistic = round(bartlett_test_A18$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A18$df,
  p_Value = round(bartlett_test_A18$p.value, 3)
)

kable(bartlett_test_A18, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 2. 2018 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2018, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS18, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

##


### 2.2. Cronbach's Alpha Skills 2018


 - For binary varibles 
 
```{r alpha2_S2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2018 <- results[["2018"]]$S_reliability$total

binary_alpha_S2018 <- binary_alpha_S2018[, -c(6:9)]

kable(binary_alpha_S2018, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 2.3. Bartlett's Test of Sphericity Skills 2018


```{r Bartletts_S2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S18 <- cortest.bartlett(cor_matrix_sortedS18, nrow(S_data_2018))

# Extract the results
bartlett_test_S18 <- data.frame(
  Statistic = round(bartlett_test_S18$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S18$df,
  p_Value = round(bartlett_test_S18$p.value, 3)
)

kable(bartlett_test_S18, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```

## 3. 2018 - Usage - Correlation, Cronbach, and Bartlett's Ttests


### 3.1. Correlations


```{r corr_U_2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU18, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 3.2. Cronbach's Alpha Usage 2018


 - For binary varibles
 
```{r alpha2_U2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2018 <- results[["2018"]]$U_reliability$total

binary_alpha_U2018 <- binary_alpha_U2018[, -c(6:9)]

kable(binary_alpha_U2018, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2018


```{r Bartletts_U2018, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U18 <- cortest.bartlett(cor_matrix_sortedU18, nrow(U_data_2018))

# Extract the results
bartlett_test_U18 <- data.frame(
  Statistic = round(bartlett_test_U18$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U18$df,
  p_Value = round(bartlett_test_U18$p.value, 3)
)

kable(bartlett_test_U18, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```


## 1. 2019 - Access - Correlation, Cronbach, and Bartlett's Ttests

### 1.1. Correlations

```{r corr_A_2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedA19, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 1.2. Cronbach's Alpha Access 2019

 - For continuous varibles
 
```{r alpha1_A2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

cont_alpha_A2019 <- results[["2019"]]$A_continuous_reliability$total

cont_alpha_A2019 <- cont_alpha_A2019[, -c(6:9)]

kable(cont_alpha_A2019, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - For binary varibles
 
```{r alpha2_A2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_A2019 <- results[["2019"]]$A_binary_reliability$total

binary_alpha_A2019 <- binary_alpha_A2019[, -c(6:9)]

kable(binary_alpha_A2019, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

 - Combining continuous and binary variables
 
```{r alpha3_A2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

comb_alpha_A2019 <- results[["2019"]]$A_combined_reliability$total

comb_alpha_A2019 <- comb_alpha_A2019[, -c(6:9)]

kable(comb_alpha_A2019, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```

### 1.3. Bartlett's Test of Sphericity Access 2019


```{r Bartletts_A2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Remove one variable from each highly correlated pair
variables_to_remove <- 5

A_data_2019_reduced <- A_data_2019_sorted[, -variables_to_remove]

# Recompute the correlation matrix
cor_matrix_reduced <- cor(A_data_2019_reduced, use = "complete.obs")

# Perform Bartlett's Test on the reduced matrix
bartlett_test_A19_reduced <- cortest.bartlett(cor_matrix_reduced, n = nrow(A_data_2019_sorted))

# Extract the results
bartlett_test_A19_reduced <- data.frame(
  Statistic = round(bartlett_test_A19_reduced$chisq, 3),
  Degrees_of_Freedom = bartlett_test_A19_reduced$df,
  p_Value = round(bartlett_test_A19_reduced$p.value, 3)
)

kable(bartlett_test_A19_reduced, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 

```


## 2. 2019 - Skills - Correlation, Cronbach, and Bartlett's Ttests

### 2.1. Correlations

```{r corr_S_2019, echo=FALSE}
load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedS19, method = "square", order = "original", tl.col = "red", tl.srt = 45)


```

## 

### 2.2. Cronbach's Alpha Skills 2019


 - For binary varibles
 
```{r alpha2_S2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_S2019 <- results[["2019"]]$S_reliability$total

binary_alpha_S2019 <- binary_alpha_S2019[, -c(6:9)]

kable(binary_alpha_S2019, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```


### 2.3. Bartlett's Test of Sphericity Skills 2019


```{r Bartletts_S2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_S19 <- cortest.bartlett(cor_matrix_sortedS19, nrow(S_data_2019))

# Extract the results
bartlett_test_S19 <- data.frame(
  Statistic = round(bartlett_test_S19$chisq, 3),
  Degrees_of_Freedom = bartlett_test_S19$df,
  p_Value = round(bartlett_test_S19$p.value, 3)
)

kable(bartlett_test_S19, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```

## 3. 2019 - Usage - Correlation, Cronbach, and Bartlett's Ttests

### 3.1. Correlations


```{r corr_U_2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

corrplot(cor_matrix_sortedU19, method = "square", order = "original", tl.col = "red", tl.srt = 45)

```

##

### 3.2. Cronbach's Alpha Usage 2019


 - For binary varibles
 
```{r alpha2_U2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

binary_alpha_U2019 <- results[["2019"]]$U_reliability$total

binary_alpha_U2019 <- binary_alpha_U2019[, -c(6:9)]

kable(binary_alpha_U2019, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header"))


```



### 3.3. Bartlett's Test of Sphericity Usage 2019


```{r Bartletts_U2019, echo=FALSE}

load(here("Scripts", "Environments", "FactoAnalysisPreProcess.RData"))

# Perform Bartlett's Test of Sphericity
bartlett_test_U19 <- cortest.bartlett(cor_matrix_sortedU19, nrow(U_data_2019))

# Extract the results
bartlett_test_U19 <- data.frame(
  Statistic = round(bartlett_test_U19$chisq, 3),
  Degrees_of_Freedom = bartlett_test_U19$df,
  p_Value = round(bartlett_test_U19$p.value, 3)
)

kable(bartlett_test_U19, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 6, latex_options = c("repeat_header")) 
```










