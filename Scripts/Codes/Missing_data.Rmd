---
title: "Tests Before Factor Analysis"
author: "Luis Carlos Castillo"
date: "`r Sys.Date()`"
institute: |
  | 
  | University of Urbino and Universty of Bremen
fontsize: 9pt
header-includes:
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{graphicx}
  - \setbeamerfont{normal text}{size=\tiny} # Adjust this line as needed
output:
  beamer_presentation: default
  slidy_presentation: default
---

```{r setup, include=FALSE}
#### 0. Load the necessary packages #####
library(readr)
library(readxl)
library(dplyr)
library(tidyr)
library(here)
library(git2r)
library(visdat)
library(naniar)
library(chatgpt)
library(gptstudio)
require(devtools)
library(caret)
library(mice)
library(knitr)
library(kableExtra)
library(corrplot)
library(forcats)
library(DescTools)
library(fastDummies)
library(corrplot)
library(Compind)
library(lme4)
library(Matrix)
library(ltm)

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(echo = FALSE, warning = F, message = F )
kableExtra.auto_format = FALSE
knitr.table.format = "latex"
knitr::opts_knit$set(kable.force.latex = TRUE)

```


```{r load_data, echo=FALSE}

load( here("Scripts", "Environments", "missing_values.RData"))
var_map <- read_xlsx(here("Data", "Processed","vars&codes.xlsx"))

```

## Importand considerations

In the process of selecting variables consistent across all six years of the ICT usage in enterprises survey (2014-2019), conducted by ISTAT, several challenges were encountered due to variations in variable codification and measurement across different years. These discrepancies suggest that the survey's methodology evolved over time, possibly to adapt to changes in technology or business practices, which occasionally led to alterations in how certain variables were defined or measured.

It is important for readers to be aware that, although the variable names and codes may vary from year to year, careful review has been conducted to ensure that each selected variable consistently measures the intended construct over the entire period. This preparatory work is critical for the next step of the analysis, which will involve data imputation to address any missing or inconsistent data points, thereby preserving the integrity of the analysis.

## List of selected variables


```{r variables, echo=FALSE}

vars_14_19 <- var_map[, 1:7]

# Assuming vars_14_19 is your DataFrame
colnames(vars_14_19) <- c("name_EN", "ict2014", "ict2015", "ict2016", "ict2017", "ict2018", "ict2019")


kable(vars_14_19, "latex", longtable = F, booktabs = T, escape = T) %>%
  kable_styling(font_size = 4)  



```

## Missing values for 2014

The missing data chart for 2014 highlights some significant challenges in data continuity for certain variables in the ICT usage in enterprises survey. Notably, the variable B5a exhibits a complete absence of data for this year, while other variables such as C8a, C8c, C8g, C8h  have missing values up to 26%. The gap in B5a is the result of changes in the survey's measurement approaches and modifications in variable codification over different survey iterations, while the other variables are missing at random. 

To manage these inconsistencies and uphold the analytical integrity of the study, a methodical approach to data imputation is being employed. For the variable B5a, with its absence in multiple years, we are utilizing interpolation techniques to estimate missing values based on available data from the years the variable is present. This ensures that the reconstructed data aligns with the observed trends over the survey period. For the other variables the mice package will be used for imputation considering the type of missingness.

## Missing chart 2014 

```{r missing2014, echo=FALSE}

vis_miss(ICT_2014Rdux, warn_large_data = FALSE)


```

## Missing values for 2015

The 2015 missing data chart for the ICT usage in enterprises survey indicates various levels of missingness among the variables, with some showing significant gaps. Notably, variable C9c displays approximately 24% missing data. Other variables such as B5a and C4 exhibit lower missing data percentages but are still noteworthy for the purposes of this study.

To address these data gaps, we will employ imputation methods tailored to the specific characteristics and missing data patterns of each variable. For variables with relatively high missing data like C9c, C8g, and C8h, the imputation process will likely involve more sophisticated statistical techniques that can utilize the available data efficiently to estimate the missing values. 

## Missing chart 2015

```{r missing2015, echo=FALSE}


vis_miss(ICT_2015Rdux, warn_large_data = FALSE)


```

##

```{r missing2016, echo=FALSE}


vis_miss(ICT_2016Rdux, warn_large_data = FALSE)


```


##


```{r missing2017, echo=FALSE}


vis_miss(ICT_2017Rdux, warn_large_data = FALSE)


```

##

```{r missing2018, echo=FALSE}


vis_miss(ICT_2018Rdux, warn_large_data = FALSE)


```

##

```{r missing2019, echo=FALSE}


vis_miss(ICT_2019Rdux, warn_large_data = FALSE)


```


